<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../../photos/logo/favicon.ico" type="image/x-icon">
    <title>Create Contract Part3</title>
    <style>
        .header {
            padding-top: 40px;
            margin-bottom: 20px;
            font-size: 20px;
            text-align: center;
            font-weight: bold;
        }

        .nav {
            display: inline-flex;
            align-items: center;
            background: white;
            height: 60px;
            width: 100%;
            padding-left: 20px;
        }

        .contentArea {
            padding: 20px;
            width: 1080px;
            background-color: white;
            margin: auto;
            border-radius: 1%;
        }

        body {
            font-family: "Inter", sans-serif;
            background: #f7f8f5;
        }

        .task-box {
            padding-bottom: 30px;
        }

        .head {
            height: 20px;
            background-color: #f7f8f5;
            margin: auto;
        }

        .headerText {
            padding-left: 30px;
            cursor: pointer;
        }

        .create-button {
            padding-top: 40px;
            display: flex;
            justify-content: center;
        }

        #create-button {
            font-family: "Inter", sans-serif;
            font-weight: 300;
            font-size: 15px;
            width: 240px;
            height: 50px;
            background-color: #699A30;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .imgItems {
            height: 60px;
        }

        .taskTitle {
            font-weight: 500;
            padding: 10px;
        }

        .standard-item-area {
            display: flex;
            align-items: center;
            padding-left: 5px;
        }

        .standard-item-code {
            width: 150px;
        }

        .standard-item-name {
            width: 600px;
        }

        .standard-item-image {
            width: 100px;
        }

        input.code {
            width: 100px;
        }

        .option-item-area {
            display: flex;
            flex-wrap: wrap;
        }

        .option-item-box {
            width: 200px; 
            margin: 5px;
        }

        .option-item-image, .option-item-code {
            text-align: center;
        }

        .subtask {
            margin-top: 10px;
        }

        .subtask-title {
            margin-bottom: 5px;
        }

        .subtask-content {
            padding: 10px;
            border-radius: 5px;
            /* border-top: 1px solid #e2e5e2; */
            border-bottom: 1px solid #e2e5e2;
        }

        .showMore {
            text-align: center;
            align-items: end;
        }

    </style>
</head>

<body>

    <div class="nav">
        <img class="headerText" src="../../photos/logo/logo.png" alt="Company Logo">
        <div class="headerText">About Us</div>
        <div class="headerText">Gallery</div>
        <div class="headerText">Contact Us</div>
        <div class="headerText" onclick="openWorkstation()">WorkStation</div>
    </div>

    <div class="head"></div>

    <div class="contentArea">
        <div class="header">Create Schedule C (Material List)</div>

        <div class="task-box">

            <div class="taskTitle">Task Kitchen:</div>

            <div>
                <input type="checkbox" id="kitchenCheckbox" onchange="toggleDisplaySubtasks('kitchenItem')">
                <label for="kitchenCheckbox">Kitchen</label>
                <div id="kitchenItem" style="display:none;">

                    <div class="subtask">

                        <div class="subtask-title">
                            <input type="checkbox" id="wallCabinetCheckbox" onchange="toggleDisplayItems('wallCabinetArea')">
                            <label for="wallCabinetCheckbox">Wall Cabinet</label>
                        </div>                        

                        <div class="subtask-content" id="wallCabinetArea" style="display:none;">
                            <div class="standard-item-area wallCabinet">
                                <div class="standard-item-code wallCabinet">
                                    <input type="input" class="code wallCabinet" value="PWMK1001"/>
                                </div>
                                <div class="standard-item-name wallCabinet">High-Gloss Lacquer in White in Scandinavian Design</div>
                                <div class="standard-item-image wallCabinet">
                                    <img class="imgItems wallCabinet" src="../../photos/material/wall-cabinet/high-gloss-lacquer-in-white-in-scandinavian-design.png"/>
                                </div>
                                <div class="showMore" onclick="toggleOptionItemsDisplay('js-option-wallCabinet-item-area')">More</div>
                            </div>
                            <div class="option-item-area js-option-wallCabinet-item-area" style="display:none;"></div>                           
                        </div>

                    </div>


                    <div class="subtask">

                        <div class="subtask-title">
                            <input type="checkbox" id="baseCabinetCheckbox" onchange="toggleDisplayItems('baseCabinetArea')">
                            <label for="baseCabinetCheckbox">Base Cabinet</label>
                        </div>

                        <div class="subtask-content" id="baseCabinetArea" style="display:none;">
                            <div class="standard-item-area baseCabinet">
                                <div class="standard-item-code baseCabinet">
                                    <input type="input" class="code baseCabinet" value="290-19"/>
                                </div>
                                <div class="standard-item-name baseCabinet">Grey Ash in Scandinavian Design</div>
                                <div class="standard-item-image baseCabinet">
                                    <img class="imgItems baseCabinet" src="../../photos/material/base-cabinet/grey-ash-in-scandinavian-design.png"/>
                                </div>
                                <div class="showMore" onclick="toggleOptionItemsDisplay('js-option-baseCabinet-item-area')">More</div>
                            </div>
                            <div class="option-item-area js-option-baseCabinet-item-area" style="display:none;"></div>
                        </div>

                    </div>


                    <div class="subtask">

                        <div class="subtask-title">
                            <input type="checkbox" id="kitchenCabinetHandleCheckbox" onchange="toggleDisplayItems('kitchenCabinetHandleArea')">
                            <label for="kitchenCabinetHandleCheckbox">Kitchen Cabinet Handle</label>
                        </div>

                        <div class="subtask-content" id="kitchenCabinetHandleArea" style="display:none;">
                            <div class="standard-item-area kitchenCabinetHandle">
                                <div class="standard-item-code kitchenCabinetHandle">
                                    <input type="input" class="code kitchenCabinetHandle" value="HD1101-76BN"/>
                                </div>
                                <div class="standard-item-name kitchenCabinetHandle">HD1101 76mm in Brush Nickel in Urbanite Series</div>
                                <div class="standard-item-image kitchenCabinetHandle">
                                    <img class="imgItems kitchenCabinetHandle" src="../../photos/material/cabinet-handle/hd1101-76mm-in-brush-nickel-in-urbanite-series.png"/>
                                </div>
                                <div class="showMore" onclick="toggleOptionItemsDisplay('js-option-kitchenCabinetHandle-item-area')">More</div>
                            </div>
                            <div class="option-item-area js-option-kitchenCabinetHandle-item-area" style="display:none;"></div>
                        </div>

                    </div>


                </div>
            </div>
        </div>


        <div class="task-box">

            <div class="taskTitle">Task Ensuite Bathroom:</div>

            <div>
                <input type="checkbox" id="ensuiteBathCheckbox" onchange="toggleDisplaySubtasks('ensuiteBathItem')">
                <label for="ensuiteBathbox">Ensuite Bathroom</label>
                <div id="ensuiteBathItem" style="display:none;">

                    <div class="subtask">

                        <div class="subtask-title">
                            <input type="checkbox" id="wallTileCheckbox" onchange="toggleDisplayItems('wallTileArea')">
                            <label for="wallTileCheckbox">Wall Tile</label>
                        </div>                      

                        <div class="subtask-content" id="wallTileArea" style="display:none;">
                            <div class="standard-item-area wallTile">
                                <div class="standard-item-code wallTile">
                                    <input type="input" class="code wallTile" value="AMSV-1224P"/>
                                </div>
                                <div class="standard-item-name wallTile">Mayfair Statuario Venato 12x24 Polished</div>
                                <div class="standard-item-image wallTile">
                                    <img class="imgItems wallTile" src="../../photos/material/tile/mayfair-statuario-venato-12x24-polished.webp"/>
                                </div>
                                <div class="showMore" onclick="toggleOptionItemsDisplay('js-option-wallTile-item-area')">More</div>
                            </div>
                            <div class="option-item-area js-option-wallTile-item-area" style="display:none;"></div>                           
                        </div>

                    </div>


                    <div class="subtask">

                        <div class="subtask-title">
                            <input type="checkbox" id="floorTileCheckbox" onchange="toggleDisplayItems('floorTileArea')">
                            <label for="floorTileCheckbox">Floor Tile</label>
                        </div>

                        <div class="subtask-content" id="floorTileArea" style="display:none;">
                            <div class="standard-item-area floorTile">
                                <div class="standard-item-code floorTile">
                                    <input type="input" class="code floorTile" value="AMSV-1224M"/>
                                </div>
                                <div class="standard-item-name floorTile">Mayfair Statuario Venato 12x24 Matte</div>
                                <div class="standard-item-image floorTile">
                                    <img class="imgItems floorTile" src="../../photos/material/tile/mayfair-statuario-venato-12x24-matte.webp"/>
                                </div>
                                <div class="showMore" onclick="toggleOptionItemsDisplay('js-option-floorTile-item-area')">More</div>
                            </div>
                            <div class="option-item-area js-option-floorTile-item-area" style="display:none;"></div>
                        </div>

                    </div>


                    <div class="subtask">

                        <div class="subtask-title">
                            <input type="checkbox" id="vanityCheckbox" onchange="toggleDisplayItems('vanityArea')">
                            <label for="vanityCheckbox">Vanity</label>
                        </div>

                        <div class="subtask-content" id="vanityArea" style="display:none;">
                            <div class="standard-item-area vanity">
                                <div class="standard-item-code vanity">
                                    <input type="input" class="code vanity" value="VSD30G"/>
                                </div>
                                <div class="standard-item-name vanity">Shaker Double Door 30-inch Gery in Vista Series</div>
                                <div class="standard-item-image vanity">
                                    <img class="imgItems vanity" src="../../photos/material/vanity/shaker-double-door-30-inch-gery-in-vista-series.png"/>
                                </div>
                                <div class="showMore" onclick="toggleOptionItemsDisplay('js-option-vanity-item-area')">More</div>
                            </div>
                            <div class="option-item-area js-option-vanity-item-area" style="display:none;"></div>
                        </div>

                    </div>


                </div>
            </div>
        </div>


    </div>

    <div class="create-button">
        <button id="create-button" type="button">Create Contract (Schedule C)</button>
    </div>

    <script src="./data-item-material.js"></script>

    <script>

        function openWorkstation() {
            console.log("Redirecting to workstation...");
            window.location.href = "../../workstation.html";
        }

        const kitchenWallCabinet = [
            {
                code: "PWMK1001",
                name: "High-Gloss Lacquer in White in Scandinavian Design",
                image: "../../photos/material/wall-cabinet/high-gloss-lacquer-in-white-in-scandinavian-design.png",
            },
            {
                code: "WBMK131",
                name: "High-Gloss Lacquer in Grey in Scandinavian Design",
                image: "../../photos/material/wall-cabinet/high-gloss-lacquer-in-grey-in-scandinavian-design.png",
            },
            {
                code: "SHOPWW",
                name: "Lacquer in White Shaker in Transitional Design",
                image: "../../photos/material/wall-cabinet/lacquer-in-white-shaker-in-transitional-design.png",
            },
            {
                code: "SHALWW",
                name: "Shaker White in Ascend Series",
                image: "../../photos/material/wall-cabinet/shaker-white-in-ascend-series.png",
            },
            {
                code: "SHALGW",
                name: "Shaker Grey in Ascend Series",
                image: "../../photos/material/wall-cabinet/shaker-grey-in-ascend-series.png",
            },
            {
                code: "MTALWW",
                name: "Matte White in Ascend Series",
                image: "../../photos/material/wall-cabinet/matte-white-in-ascend-series.png",
            },
            {
                code: "MTALGW",
                name: "Matte Grey in Ascend Series",
                image: "../../photos/material/wall-cabinet/matte-grey-in-ascend-series.png",
            },
            {
                code: "WDALGW",
                name: "Wood Grey in Ascend Series",
                image: "../../photos/material/wall-cabinet/wood-grey-in-ascend-series.png",
            },
            {
                code: "OKALWW",
                name: "White Oak in Ascend Series",
                image: "../../photos/material/wall-cabinet/white-oak-in-ascend-series.png",
            },
            {
                code: "HGALWW",
                name: "High Gloss White in Ascend Series",
                image: "../../photos/material/wall-cabinet/high-gloss-white-in-ascend-series.png",
            },
            {
                code: "HGALGW",
                name: "High Gloss Grey in Ascend Series",
                image: "../../photos/material/wall-cabinet/high-gloss-grey-in-ascend-series.png",
            },
            {
                code: "HGALLGW",
                name: "High Gloss Light Grey in Ascend Series",
                image: "../../photos/material/wall-cabinet/high-gloss-light-grey-in-ascend-series.png",
            },
        ];


        const itemsByType = {
            wallCabinet: kitchenWallCabinet,
            baseCabinet: kitchenBaseCabinet,
            kitchenCabinetHandle: kitchenCabinetHandle,
            wallTile: bathWallTile,     
            floorTile: bathFloorTile,   
            vanity: bathVanity,        
        };

        function populateOptionItems(type) {
            const optionItems = itemsByType[type];
            const containerClass = `.js-option-${type}-item-area`;
            let optionsHTML = '';
            optionItems.forEach((item, index) => {
                optionsHTML += `
                    <div class="option-item-box" onclick="updateStandardItem(${index}, '${type}')">
                        <div class="option-item-image">
                            <img class="imgItems" src="${item.image}" alt="${item.name}" />
                        </div>
                        <div class="option-item-code">${item.code}</div>
                    </div>
                `;
            });
            document.querySelector(containerClass).innerHTML = optionsHTML;
        }



        function updateStandardItem(index, type) {
            const item = itemsByType[type][index];
            updateStandardItemByCode(item, type);
        }

        function updateStandardItemByCode(item, type) {
            const codeInputSelector = `.standard-item-code.${type} input`; 
            const nameSelector = `.standard-item-name.${type}`;
            const imageSelector = `.standard-item-image.${type} img`; 

            const codeInputElement = document.querySelector(codeInputSelector);
            const nameElement = document.querySelector(nameSelector);
            const imageElement = document.querySelector(imageSelector);

            if (codeInputElement && nameElement && imageElement) {
                codeInputElement.value = item.code;
                nameElement.textContent = item.name;
                imageElement.src = item.image;
            } else {
                console.log('Elements not found:', { codeInputElement, nameElement, imageElement });
            }
        }



        ['wallCabinet', 'baseCabinet', 'kitchenCabinetHandle', 'wallTile', 'floorTile', 'vanity'].forEach(type => {
            populateOptionItems(type);
        });


        function setupInputEventListeners() {
            ['wallCabinet', 'baseCabinet', 'kitchenCabinetHandle', 'wallTile', 'floorTile', 'vanity'].forEach(type => {
                addInputEventListener(`.standard-item-code.${type} input`, type);
            });
        }

        function addInputEventListener(selector, type) {
            const inputElements = document.querySelectorAll(selector);
            inputElements.forEach(inputElement => {
                inputElement.addEventListener('keydown', function(event) {
                    if (event.key === 'Enter') {
                        const inputCode = event.target.value.toUpperCase();
                        const matchingItem = itemsByType[type].find(item => item.code.toUpperCase() === inputCode);
                        if (matchingItem) {
                            updateStandardItemByCode(matchingItem, type);
                        }
                    }
                });
            });
        }


        ['wallCabinet', 'baseCabinet', 'kitchenCabinetHandle', 'wallTile', 'floorTile', 'vanity'].forEach(type => {
            addInputEventListener(`.standard-item-code.${type} input`, type);
        });



        function toggleDisplaySubtasks(elementId) {
            let element = document.getElementById(elementId);
            element.style.display = (element.style.display === 'none' ? 'block' : 'none');
            console.log(`Toggled display of subtasks for ${elementId}: ${element.style.display}`);
        }

        function toggleDisplayItems(itemId) {
            let item = document.getElementById(itemId);
            item.style.display = (item.style.display === 'none' ? 'block' : 'none');
            console.log(`Toggled display of items for ${itemId}: ${item.style.display}`);

            let optionsArea = item.querySelector('.option-item-area');
            if (optionsArea) {
                optionsArea.style.display = 'none';
                console.log(`Option items hidden for ${itemId}`);
            }
        }


        function toggleOptionItemsDisplay(optionAreaClass) {
            let optionArea = document.querySelector('.' + optionAreaClass);
            if (optionArea) {
                console.log("Current display before toggle:", optionArea.style.display); 
                optionArea.style.display = (optionArea.style.display === 'none' || optionArea.style.display === '') ? 'flex' : 'none';
                console.log(`Toggled option items display for ${optionAreaClass}: ${optionArea.style.display}`);
                // console.log("Inner HTML of the area:", optionArea.innerHTML); 
            } else {
                console.log(`Failed to find option area with class: ${optionAreaClass}`);
            }
        }


        function createContract() {
            let dataToSave = [];

            const subtasks = document.querySelectorAll('.subtask-content');
            subtasks.forEach((subtask) => {
                const subtaskCheckboxId = subtask.id.replace('Area', 'Checkbox');
                if (document.getElementById(subtaskCheckboxId).checked) {
                    const itemLabel = document.querySelector(`label[for=${subtaskCheckboxId}]`).textContent;
                    const itemName = subtask.querySelector('.standard-item-name').textContent;
                    const itemCode = subtask.querySelector('.standard-item-code input').value;
                    const itemImage = subtask.querySelector('.standard-item-image img').src;
                    dataToSave.push({ itemLabel, itemName, itemCode, itemImage });
                }
            });

            localStorage.setItem('subtasksData', JSON.stringify(dataToSave));
            window.open('./contract-part3.html', '_blank');
        }

        document.getElementById('create-button').addEventListener('click', createContract);

        document.addEventListener('DOMContentLoaded', setupInputEventListeners);


    </script>
</body>
</html>
